<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM based Bayesian Network</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/cytoscape@3.23.0/dist/cytoscape.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/webcola@3.4.0/WebCola/cola.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-cola@2.5.1/cytoscape-cola.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-context-menus@2.1.0/cytoscape-context-menus.min.js"></script>
</head>
<body>
    <h1>Dynamic LLM-Powered Cognitive Network</h1>

    <div id="loading-spinner" class="spinner hidden"></div>

    <div class="config-manager">
        <h2>Configuration Management</h2>
        <div>
            <label for="config-name">Config Name:</label>
            <input type="text" id="config-name" placeholder="Enter name to save">
            <button id="save-config-button" title="Save the current graph structure">Save Current Config</button>
        </div>
        <div>
            <label for="load-config-select">Load/Manage Config:</label>
            <select id="load-config-select">
                <option value="">-- Select a config --</option>
            </select>
            <button id="load-config-button" title="Load the selected configuration">Load Selected</button>
            <button id="set-default-button" title="Set the selected configuration as default">Set as Default</button>
            <button id="delete-config-button" title="Delete the selected configuration">Delete Selected</button>
        </div>
        <p id="config-status" class="status-message"></p>
    </div>

    <div class="controls">
        <h2>Inputs (Probabilities 0.0 - 1.0)</h2>
        <div id="input-controls-container">
            <p>Load a configuration to see inputs.</p>
        </div>
        <label for="gradient-toggle">Enable Gradient Coloring:</label>
        <input type="checkbox" id="gradient-toggle" checked><br>
        <button id="update-button" title="Run LLM prediction with current inputs">Update Probabilities</button>
        <p id="predict-status" class="status-message"></p>
    </div>

    <div id="cy"></div>

    <div class="logging-controls">
        <h2>Logging</h2>
        <p>Current Config: <strong id="current-config-name">None</strong></p>
        <button id="download-session-log-button" title="Download predictions from this session">Download Session Log (CSV)</button>
        <button id="download-all-log-button" title="Download all historical predictions for the current config">Download All Logs for Config (CSV)</button>
        <p id="log-count">Log entries this session: 0</p>
    </div>

    <div class="llm-context">
        <h2>LLM Reasonings</h2>
        <div id="llm-reasoning-content">
            <p>Run prediction to see LLM reasonings.</p>
        </div>
        <details>
            <summary>Show LLM Input Context</summary>
            <div id="input-context">
                <h3>Input States Provided:</h3>
                <p>Run prediction to see context.</p>
            </div>
            <div id="structure-context">
                <h3>Node Dependencies (DAG):</h3>
                <p>Run prediction to see context.</p>
            </div>
            <div id="node-descriptions-context">
                <h3>Node Descriptions:</h3>
                <p>Run prediction to see context.</p>
            </div>
        </details>
    </div>

    <div class="graph-editor">
        <h2>Graph Editor</h2>
        <p>Right-click nodes or the canvas to add/remove nodes and edges.</p>
    </div>

    <script src="script.js"></script>
</body>
</html>
